# 微博热搜博物馆 2.0

------

![微博热搜博物馆](https://pic4.zhimg.com/v2-6fbff11cb4d1fc143edabcf1e33ede8e_1440w.jpg)

欢迎访问 **微博热搜博物馆** 开源项目仓库。一个开放的微博热搜历史数据检索系统。通过本仓库开源代码可以实现私有化部署。

> 不知不觉线上项目已运行近半年，感谢赞助过的朋友们！因为有你们的支持才有现在的成就！
>
> Lee	AD	L*a	*温	*琦	*者	*奥	清伍	meltshock	*分	许可(知乎)	*岸	*强	*雪	❄️	

其主要提供以下核心功能：

> * 根据时间检索热搜内容
> * 根据关键词检索相关内容
> * 检索热搜排名趋势
> * 检索热搜搜索量趋势

相关使用功能介绍请移步  [知乎：分享一个微博热搜历史记录网站 - 微博热搜博物馆]( https://zhuanlan.zhihu.com/p/133192873)  

##  部署说明

### 服务器规格

* CPU ：云服务器不应小于2核心 
* 内存：> 1G
* 存储：> 5GB
* 带宽：> 1Mbps
* 系统：Windows

###  运行环境

* Nginx 
* MySql > 5.5
* PHP  7.2 且加入系统环境变量

###  WEB服务器 

* 支持`Pathinfo`方式传递参数
* 启用URL改写功能
* 请将网站根目录设置为 `/项目目录/public `目录下。

URL 改写规则（Nginx）(通用Thinkphp5 URL改写规则)

```
if (!-e $request_filename) { 
        rewrite  ^(.*)$  /index.php?s=$1  last; 
        break;   
														} 
```

###  数据库

在MySql中创建新数据库，导入 `OtherFile/数据库`目录内容。请牢记数据库账户密码以及您所创建使用的数据库名称。

###  热搜信息采集

使用前先配置  `OtherFile/config.ini` 配置文件内容。使其数据库配置信息与主项目一致，关闭DEBUG模式。`daily`为延迟采集时间。默认每分钟的第0秒+`daily` 秒数开始采集本时间段内热搜数据。配置完毕后执行`热搜数据采集.exe`可执行文件。

###  项目运行全局配置

项目相关配置文件全部位于 `项目根目录/conf`目录下。部署时请根据文件内注释配置`config.php`与`databases.php` 文件。

###  管理后台

后台地址为  网站地址/manage.php

默认不开设账户。账户列表位于数据库/auth 内。需填写username 即 您的登陆名称。

`pwd` 即为密码选项。默认密码加密法则为：`md5 计算 T5kijhL7bq您的密码5yCO0A`

`sec_code` 为安全码，明文填写。

###  开始运行

上述操作全部完成后，打开`项目目录/public`

您会发现有许多`.bat`脚本内容。

* 分拣缓存表数据-慢		数据库热搜数据分拣入库，默认每30s执行一次。线上环境务必开启！
* 分拣缓存表数据-快        数据库热搜数据分拣入库，默认每秒钟执行一次，测试环境或者积压数据过多时使用。
* 检查最大值纪录             热搜详情页面显示当前热搜最高排名，最高搜索量等数值。由于部分热搜存在断面导致程序经常运算出错，定期使用此脚本纠正数据库内标记重新核验热搜条目数据。线上环境保持开启即可。
* 缺少最大值纪录时重建数据    当数据库内热搜条目最大值为空时使用此脚本重建数据。通常无需使用
* 审计访问防火墙             可根据用户IP访问频次进行拉黑屏蔽处理。此模块通常不建议开启。
* 自动创建核查最大值纪录标记    自动定期创建最大值数据待核查标记，使用`检查最大值纪录`脚本进行核查即可。

以上脚本当您明确各个脚本作用后可任意进行重命名操作。但不可移动其位置。

---

Meloncn 2020

interestingcn01@gmail.com